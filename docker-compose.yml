# Knowledge Portal
# A self-hosted, AI-enhanced learning platform.
# Step 1: Offline Wikipedia via Kiwix
#
# Usage:
#   cp .env.example .env        # adjust paths/ports
#   ./scripts/setup.sh           # initial download + directory setup
#   docker compose up -d         # start serving
#
# Future services (Calibre, Ollama, vector DB, etc.) will be added
# to this compose file as the portal grows.

services:
  kiwix:
    image: ghcr.io/thetechild/knowledge-portal:latest
    container_name: kiwix-wikipedia
    ports:
      - "${KIWIX_PORT:-8081}:8080"
    volumes:
      - ${LIBRARY_PATH:-/mnt/user/knowledge/library}:/data:ro
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:8080", "||", "exit", "1"]
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 30s
    labels:
      - "knowledge-portal.service=kiwix"
      - "knowledge-portal.description=Offline knowledge library via Kiwix"
